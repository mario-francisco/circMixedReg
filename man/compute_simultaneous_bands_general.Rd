% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_simultaneous_bands_general.R
\name{compute_simultaneous_bands_general}
\alias{compute_simultaneous_bands_general}
\title{Compute Simultaneous Bootstrap Confidence Bands for Circular Regression (General Version)}
\usage{
compute_simultaneous_bands_general(
  data,
  x_grid,
  z_level,
  h,
  lambda,
  B = 200,
  alpha = 0.05,
  delta = alpha/10,
  max_iter = 20,
  cont_col = "X",
  cat_col = "Z",
  response_col = "theta",
  kernel_continuous = gaussian_kernel,
  kernel_categorical = aitchison_aitken_kernel,
  kernel_levels = NULL,
  seed = NULL,
  plot = FALSE,
  style = c("points", "ribbon"),
  show_estimate = FALSE,
  arrows = TRUE,
  predict_fun = nw_circular_predict
)
}
\arguments{
\item{data}{Data frame containing the observed sample.}

\item{x_grid}{Numeric vector of values of the continuous predictor at which to evaluate the bands.}

\item{z_level}{Character; level of the categorical predictor to condition on.}

\item{h}{Bandwidth for the continuous predictor.}

\item{lambda}{Smoothing parameter for the categorical predictor.}

\item{B}{Number of bootstrap replicates. Default is 200.}

\item{alpha}{Nominal significance level (e.g., 0.05 for 95\% bands).}

\item{delta}{Tolerance for the final coverage approximation. Default is \code{alpha / 10}.}

\item{max_iter}{Maximum number of calibration iterations. Default is 20.}

\item{cont_col}{Name of the continuous predictor column.}

\item{cat_col}{Name of the categorical predictor column.}

\item{response_col}{Name of the circular response column (in radians).}

\item{kernel_continuous}{Kernel function for the continuous predictor.}

\item{kernel_categorical}{Kernel function for the categorical predictor.}

\item{kernel_levels}{Optional list of levels for ordinal kernels.}

\item{seed}{Optional integer seed for reproducibility.}

\item{plot}{Logical. If TRUE, produces a ggplot2 visualization of the bands.}

\item{style}{Character. Either "points" or "ribbon" to control the plot appearance.}

\item{show_estimate}{Logical. If TRUE, adds the estimated regression curve to the plot.}

\item{arrows}{Logical. If TRUE and style = "points", adds directional arrows to indicate the interval span.}

\item{predict_fun}{Prediction function to use (e.g., \code{nw_circular_predict}, \code{ll_circular_predict}).}
}
\value{
A list with components:
\describe{
\item{x}{Grid of x values}
\item{estimate}{Estimated regression function}
\item{lower}{Lower simultaneous confidence band}
\item{upper}{Upper simultaneous confidence band}
\item{alpha_final}{Final calibrated level used for band construction}
\item{coverage}{Bootstrap proportion of curves entirely inside the band}
\item{iterations}{Number of iterations used}
\item{method}{"bonferroni" or "iterative" depending on which was applied}
}
}
\description{
Constructs approximate simultaneous (1 - alpha) confidence bands for a circular regression function,
using bootstrap calibration between individual and Bonferroni bands.
}
\details{
The function automatically decides whether to apply the iterative procedure based on the coverage
achieved by Bonferroni bands. Two visualization styles are available: "points" (with optional arrows)
and "ribbon" (traditional band). For circular data, the "points" style is often more appropriate.
}
\examples{
# Example (assuming data is preloaded with columns X, Z, theta):
# compute_simultaneous_bands_general(data, x_grid = seq(0,1,length.out=100),
#                                    z_level = "cond1", h = 0.2, lambda = 0.5,
#                                    plot = TRUE, style = "points",
#                                    show_estimate = TRUE, arrows = TRUE)

}
