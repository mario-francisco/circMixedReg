% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_residuals.R
\name{compute_residuals}
\alias{compute_residuals}
\title{Compute Residuals for Circular Regression (NW or LL)}
\usage{
compute_residuals(
  data,
  response_col = "theta",
  cont_cols = NULL,
  cat_cols = NULL,
  h = 0.5,
  lambda = 0.5,
  kernel_continuous = gaussian_kernel,
  kernel_categorical = aitchison_aitken_kernel,
  kernel_levels = NULL,
  estimator = "NW"
)
}
\arguments{
\item{data}{Data frame containing the sample, including the response and predictors.}

\item{response_col}{Name of the column with the circular response (in radians). Default is \code{"theta"}.}

\item{cont_cols}{Character vector with the names of the continuous predictors.}

\item{cat_cols}{Character vector with the names of the categorical predictors.}

\item{h}{Vector of bandwidths for continuous predictors (scalar or vector).}

\item{lambda}{Vector of smoothing parameters for categorical predictors (scalar or vector).}

\item{kernel_continuous}{Kernel function for continuous predictors.}

\item{kernel_categorical}{Kernel function for categorical predictors.}

\item{kernel_levels}{Optional list of level vectors for each categorical variable (used by ordinal kernels).}

\item{estimator}{Character string: either \code{"NW"} (default) or \code{"LL"}.}
}
\value{
A numeric vector of residuals (in radians), normalized to the interval (-pi, pi).
}
\description{
Computes circular residuals between observed values and predicted values
from a nonparametric regression model with mixed-type predictors (continuous + categorical),
using either Nadaraya-Watson or local linear kernel smoothing.
}
\examples{
# Simulated example
set.seed(123)
n <- 50
x <- runif(n)
z <- sample(c("A", "B", "C"), n, replace = TRUE)
theta <- (pi * x + circular::rvonmises(n, mu = circular::circular(0), kappa = 3)) \%\% (2 * pi)
df <- data.frame(x = x, z = z, theta = theta)

# Compute NW residuals
res_nw <- compute_residuals(df, cont_cols = "x", cat_cols = "z",
                             h = 0.2, lambda = 0.5,
                             kernel_continuous = gaussian_kernel,
                             kernel_categorical = aitchison_aitken_kernel,
                             estimator = "NW")

# Compute LL residuals
res_ll <- compute_residuals(df, cont_cols = "x", cat_cols = "z",
                             h = 0.2, lambda = 0.5,
                             kernel_continuous = gaussian_kernel,
                             kernel_categorical = aitchison_aitken_kernel,
                             estimator = "LL")

summary(res_nw)
summary(res_ll)

}
