% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap_bandwidth_selector_parallel.R
\name{bootstrap_bandwidth_selector_parallel}
\alias{bootstrap_bandwidth_selector_parallel}
\title{Bootstrap Bandwidth Selector (Parallel) for Circular Regression}
\usage{
bootstrap_bandwidth_selector_parallel(
  data,
  response_col = "theta",
  cont_cols = NULL,
  cat_cols = NULL,
  h_grid = NULL,
  lambda_grid = NULL,
  h0,
  lambda0,
  h1,
  lambda1,
  B = 100,
  eps_bootstrap = NULL,
  kernel_continuous = gaussian_kernel,
  kernel_categorical = aitchison_aitken_kernel,
  kernel_levels = NULL,
  estimator = "NW",
  parallel = TRUE
)
}
\arguments{
\item{data}{A data frame containing the dataset.}

\item{response_col}{Name of the column with the circular response (in radians).}

\item{cont_cols}{Character vector with the names of the continuous predictor columns.}

\item{cat_cols}{Character vector with the names of the categorical predictor columns.}

\item{h_grid}{List of candidate bandwidth vectors for the continuous predictors. If NULL, a default grid is generated.}

\item{lambda_grid}{List of candidate lambda vectors for the categorical predictors. If NULL, a default grid is generated.}

\item{h0, lambda0}{Pilot bandwidths used to estimate residuals.}

\item{h1, lambda1}{Pilot bandwidths used to generate pseudo-responses.}

\item{B}{Number of bootstrap replicates to approximate the CMISE.}

\item{eps_bootstrap}{Optional matrix of bootstrap errors (n x B) for reproducibility. If NULL (for standard use), they are generated internally.}

\item{kernel_continuous}{Kernel function for continuous predictors.}

\item{kernel_categorical}{Kernel function for categorical predictors.}

\item{kernel_levels}{Optional list of levels for each categorical variable (needed if \code{kernel_categorical} is ordinal).}

\item{estimator}{Either "NW" (default) or "LL" to choose the regression method.}

\item{parallel}{Logical. Whether to use parallel evaluation across the grid (default TRUE).}
}
\value{
A list with the selected bandwidths \code{h_boot}, \code{lambda_boot}, and the estimated CMISE.
}
\description{
Selects optimal bandwidths for nonparametric circular regression with mixed-type predictors,
by minimizing a bootstrap approximation of the Circular Mean Integrated Squared Error (CMISE).
This version uses parallel evaluation over the bandwidth grid using \code{future_sapply()},
with proper handling of random number generation to ensure reproducibility.
}
\note{
To ensure exact reproducibility across parallel and sequential versions, you can externally
generate the same bootstrap residual matrix (n x B) and pass it to both functions via the
\code{eps_bootstrap} argument. Otherwise, internal sampling may differ.

This function uses parallel computing via the \pkg{future} and \pkg{future.apply} packages.
To enable parallel execution, configure the parallel plan at the beginning of the session using:
\code{future::plan(future::multisession, workers = N)}, where \code{N} is the number of CPU cores.
}
