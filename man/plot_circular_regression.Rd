% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_circular_regression.R
\name{plot_circular_regression}
\alias{plot_circular_regression}
\title{Plot One or Multiple Circular Regression Curves}
\usage{
plot_circular_regression(
  x_grid,
  m_hat_list,
  labels = NULL,
  colors = NULL,
  linetypes = NULL,
  true_fun = NULL,
  true_fun_list = NULL,
  true_labels = NULL,
  x_obs = NULL,
  theta_obs = NULL,
  cylinder = FALSE,
  title = "Circular Regression Curve",
  xlab = "x",
  ylab = "Estimated angle (radians)"
)
}
\arguments{
\item{x_grid}{Numeric vector of grid values for the predictor.}

\item{m_hat_list}{A list of vectors of estimated circular values (in radians), each representing a curve.}

\item{labels}{Optional character vector with names for each estimated curve (used in the legend).}

\item{colors}{Optional character vector with colors for all curves (estimated + true). Defaults to black.}

\item{linetypes}{Optional character vector with line types (e.g., \code{"solid"}, \code{"dashed"}).}

\item{true_fun}{Optional. A single function that computes a true regression curve.}

\item{true_fun_list}{Optional. A list of true functions to draw multiple curves (e.g., one per group).}

\item{true_labels}{Optional. Labels for the true functions in the legend.}

\item{x_obs}{Optional. Vector of predictor values for observed data points.}

\item{theta_obs}{Optional. Vector of observed circular responses (in radians).}

\item{cylinder}{Logical. If \code{TRUE}, plots curves on a cylindrical (polar-y) coordinate system.}

\item{title}{Title of the plot.}

\item{xlab}{Label for the x-axis.}

\item{ylab}{Label for the y-axis. Ignored if \code{cylinder = TRUE}.}
}
\value{
A \code{ggplot} object.
}
\description{
Visualizes estimated circular regression curves over a grid of values. Optionally overlays observed data points,
multiple true regression functions (e.g., one per group), and supports plotting in a cylindrical coordinate layout.
}
\examples{
# Simulated example: NW vs LL on a single group
set.seed(123)
n <- 100
x <- runif(n, -1, 1)
z <- factor(rep("A", n))
m_fun <- function(x) pi * sin(pi * x)
theta <- (m_fun(x) + circular::rvonmises(n, mu = circular::circular(0), kappa = 3)) \%\% (2 * pi)

# Grid for estimation
x_grid <- seq(-1, 1, length.out = 200)
z0 <- "A"

# Estimate with NW and LL
m_hat_nw <- sapply(x_grid, function(x0)
  nw_circular_mixed(
    x0 = x0, z0 = z0,
    X = matrix(x, ncol = 1),
    Z = data.frame(z),
    theta = theta,
    h = 0.3, lambda = 0.3,
    kernel_continuous = gaussian_kernel,
    kernel_categorical = aitchison_aitken_kernel
  ))

m_hat_ll <- sapply(x_grid, function(x0)
  ll_circular_mixed(
    x0 = x0, z0 = z0,
    X = matrix(x, ncol = 1),
    Z = data.frame(z),
    theta = theta,
    h = 0.3, lambda = 0.3,
    kernel_continuous = gaussian_kernel,
    kernel_categorical = aitchison_aitken_kernel
  ))

# Plot both curves and the true function
plot_circular_regression(
  x_grid = x_grid,
  m_hat_list = list(NW = m_hat_nw, LL = m_hat_ll),
  labels = c("NW", "LL"),
  colors = c("red", "blue"),
  linetypes = c("solid", "dotted"),
  true_fun = m_fun,
  x_obs = x,
  theta_obs = theta,
  title = "Estimated Circular Regression Curves"
)
}
